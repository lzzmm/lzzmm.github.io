---
layout:     post
title:      去北京
subtitle:   International Competition of Autonomous Running Robots 2020
date:       2020-10-19
author:     划水炸毛
timecost:   15 minutes
# header-style: black
# header-mask: 0.01
header-img-credit:      Chen Yuhan
header-img-year:        2020
header-img-outchain:    true
header-img: https://s3.ax1x.com/2020/11/22/D8hRTe.jpg
# nav-style: invert
catalog: true
mathjax: false
live2d:  true
tags:
---

# 起因

3月份还在家的时候，刚教授发来消息，让我去参加比赛。我以前从未参加过这种比赛，向来觉得十分复杂而又费力。但是想起自己论文没看几篇，也不敢拒绝。

去年我们学校拿了一等奖和三等奖，我觉得有前人指导可能有戏，没想到最后去丢脸了==

2019年是6月份报名，暑假准备一个月，八月底比赛。

于是开始学习opencv，虽然寒假就开始看了，但是还是没有认真学。这下要每天抽时间学了。

## 6-10 线上说明会

今年由于疫情，故有了调整：

- 增设线上比赛，使用仿真软件运行代码；
- 增加图像处理难度，赛道图案复杂，取消定位用的黑线；
- 动作难度增加，包括直立连续上下台阶，下坡平衡能力等；

还有其他改变：

- 标准赛机器人升级了 `树莓派4B` （埋下伏笔）；
- 可以手动调节舵机调整动作组；

标准赛可选两款机器人，去年用的是幻尔，今年刚教授作为顾问组一员，推荐我们使用乐聚（埋下伏笔）。

##### AELOS PRO

- Raspberry pi 4B 1.5GHz 4-Core ARM-A72 4G LPDDR4
- 2x Camera
- 7.2V 2200mAh
- 346mm\*224mm\*118 1.76kg
- STM32 F103

## 6-22 Prof. Gang 开会

- 比赛延期到10月份；
- 现场赛不知是否取消；
- 期末，写代码时间后延；
- 广角镜头需要矫正；

## 7-31 开会

这段时间我一直在研究webots虚拟平台，机器人好像寄到了师姐家里，但是大家在家都没啥心思捣鼓。

- 关卡随机出现，需要识别和判断；
- 比赛场地颜色与实验室不同；
- 试验动作组并编号；
- 算法鲁棒性，包括错误情况（如摔倒）恢复；
- 做好版本控制；

## 8-27

天下着雨，吃过午饭便来到汕头站，顺利取了学生票。候车大厅很热，好在只等了一小会儿便开始检票上车。靠窗的邻座是一位暨南大学的肥宅，他一上车就开始吃pocky，手机在QQ群兵分几路聊天水群。

第一次坐开往广州南的复兴号，比和谐号舒服一点。携带的两盆小绿植————一盆年初在舅公田里拔的薄荷和一盆不知道怎么称呼的草，恰好有地方放，比想象中的要顺利。

地铁多了请戴好口罩的提示，走出大学城北迎着快落山的夕阳。从下雨的汕头来到晴朗的广州，或许也应该走出疫情在家时的颓废开始崭新的大二生活了吧。

## 开学

没想到开学就是为期两周的期末考+CET6，白天还要上课……

实验室也突然没有了地方，因为不是假期，所以人都坐满了。赛道什么的也还没买。

考完试开始搭赛道，九月下旬Gang教授在实验楼A找了处地方。

## 09-27 使用VNC第一次执行了台阶

动作并不稳定，还需要调整。

## 10-8

大赛将近，赛道还是不像样。平时也没怎么和队友见面，日常一个人实验室写作业。事实证明没有ddl的情况下大家都是能摸则摸。

离比赛只有几天时间，机器人的头部舵机突然烧坏。联系乐聚，结果寄来一个新的直接寄到中山市。没想到“中山大学在广州深圳珠海就是不在中山”不只是个梗。

好在出发前两天到了。

在这时认识了上交的热心老哥，具体可以跳转到~~[这里](https://cleveryh.github.io/2020/10/31/oct-is-gone/#04)查看。~~

## 10-16

最后两天通宵调试，出发那天3点从实验室回宿舍，睡到7点差点叫不醒。

下午到达北京科学中心，没有携带路由器和网线。借了上交的路由器和网线，场地网络环境十分复杂，等到连接上机器人太阳已经落山，科学中心B1层的光照变化，很难采集赛道颜色，这对大量通过颜色掩膜算法来判断的我们来说雪上加霜。晚上去东来顺吃了一顿涮羊肉，没想到这是在北京吃的最好的一顿。

科学中心10点关了门，本想调试结果一回宾馆也没办法调试，一躺下去就睡着了。

## 10-17

早上赛前调试了一波，效果并不好，还在不停采样和改bug。下午比赛，由于前面队伍要不然就很快失败要不然就弃赛，我们很快就上了。第一次尝试，黄色衣服工作人员干扰，导致判定不出黄黑色的门杆是否抬起。于是重新试了一遍，将独木桥识别成方坑，失败。第二次尝试，在地雷阵时提前翻挡板。

果然还是丢人了，结束了，拍张合影还机器人，就可以去玩了。

没想到中午的时候发了通知，说由于大家成绩都不怎么样，明天还能加赛。总之要努力拿个奖吧！

于是开始拿回机器人，开始通宵调代码。由于赛道降低了难度，故开始适当打表（×）。

## 10-18

凌晨叫了个粥的外卖，我向上交学习先进经验调下蹲慢走过门动作。当时也没有侧身通过的想法，思维已经有点混乱了。两点的时候出去透气，保安是河北人，和他聊了两句。想起刚下飞机那个网约车司机，说起北京交警抓没有北京户口的司机，而且每次罚一两万，不竭泽而渔。那个司机魔性的笑声让我感受到了面对困难和不公平的乐观态度。

凌晨五点我跑去睡觉，结果大家都一觉睡到了七点。

比赛又开始了，第一次卡住了，第二次在地雷关倒下，第三次成功踹飞地雷翻过挡板卡在门口。

此刻我觉得十分后悔。

# 教训

1. 队伍组建选择队员很重要，队员要有集体和团队意识，要珍惜比赛机会，认真对待。因为只要有一个人不认真就会导致其他人不认真。
2. 队内工作协调
   1. 队长要做好协调和分配工作，不能太过于放松。包括定时听取汇报、了解和搜集情报、及时与指导老师沟通寻求帮助等；
   2. 重视版本控制，本地文件备份（华科调整通宵之后代码不小心被删除）；
   3. 队伍内不能各做各的，要对其他成员的工作有所了解，要掌握整体工作进展；
3. 在实验室搭建赛道环境要尽快并且尽量接近标准：
   - 这次比赛存在有两个问题，一个是疫情，一个是官方标准场地没有提前给出标准；
   - 我们也遇到了实验室场地不够的问题，推迟了进度；
4. 注意研究比赛规则，进行讨论和分析。如今年不能跳关，应该将重心放在前几关并且逐关解决问题。
5. 遇到问题先找主办方，他们会解决大部分问题。
6. 乐聚机器人小电池高能耗芯片导致续航紧张，并且不可更换你电池很影响准备和调整。
7. 不应该太过依赖上一届比赛的开源代码，应该找自己师兄的代码来看看，避免思维陷入定势。
   1. 方坑的趴过方法对于幻儿可行但是对于乐聚不可行，走过去是最优解；
   2. 过门侧身过是最优解；
   3. 没有利用好两个摄像头的协同，没有充分利用硬件。 Raspberry pi 4B算力升级，有更多的想象空间。
8. 算法要尽量robust，我们由于准备时间不充分，算法很不robust。
9. 心态放好，自闭很浪费时间，不怕丢脸，不重名利，享受过程。

# 总结

总体来说都是准备时间多的队伍成绩要好，我们准备时间少其实是因为太过摸鱼并且新学期事情很多。唉，不过力有余而心不足的人总是会后悔。

1. 第一关，开门。没啥好说的，使用头部摄像头判断黄色掩膜区域大小，<5%时往前快走通过。
2. 接下来的关卡都是随机的，赛前判断只有方坑和独木桥、门和挡板会调换顺序，没想到果真如此。
3. 独木桥
   1. 上交使用了测量角度后快走通过，如果舵机刚度不够很容易走偏翻车；
   2. 我们测量后快走三步，再测量后再快走三步；
4. 方坑
   1. 上交采用检测线性边缘的算法；
   2. 我们一开始方向错了，找颜色掩膜，最后改成检测两侧边缘和水平线角度；
5. 地雷阵好像挺容易翻车的，最后大家好像都打表了。
6. 挡板识别后翻过，问题不大。
7. 过门还是要侧身通过。
8. 独木桥做颜色掩膜找矩形。
9. 踢球很多队伍都放弃了，因为地面图案复杂。坚持的队伍要不就走不到那一关，要不就找不到球。或许可以使用霍夫变换找出直线……
10. 连续上楼，是我负责的。多次检测阶梯并矫正，动作要很稳定，同时需要防滑，下楼同理。斜坡则需要蹲走保持低重心。
11. 最后一关也是个门，可以稍等一下判断关闭后打开再通过，否则可能刚好在关门时通过然后被打倒。

明年不知道还会不会参加，无论如何学到了很多，不虚此行。

就是不知道报销啥时候才下来(￣▽￣)"
